'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);var _assign = require('babel-runtime/core-js/object/assign');var _assign2 = _interopRequireDefault(_assign);var _regenerator = require('babel-runtime/regenerator');var _regenerator2 = _interopRequireDefault(_regenerator);var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);var _extends2 = require('babel-runtime/helpers/extends');var _extends3 = _interopRequireDefault(_extends2);var _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');var _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);var _stringify = require('babel-runtime/core-js/json/stringify');var _stringify2 = _interopRequireDefault(_stringify);var _mapValues2 = require('lodash/fp/mapValues');var _mapValues3 = _interopRequireDefault(_mapValues2);var _toPairs2 = require('lodash/fp/toPairs');var _toPairs3 = _interopRequireDefault(_toPairs2);var _map3 = require('lodash/fp/map');var _map4 = _interopRequireDefault(_map3);var _join2 = require('lodash/fp/join');var _join3 = _interopRequireDefault(_join2);var _compose2 = require('lodash/fp/compose');var _compose3 = _interopRequireDefault(_compose2);var _isNil2 = require('lodash/fp/isNil');var _isNil3 = _interopRequireDefault(_isNil2);var _negate2 = require('lodash/fp/negate');var _negate3 = _interopRequireDefault(_negate2);var _pickBy2 = require('lodash/fp/pickBy');var _pickBy3 = _interopRequireDefault(_pickBy2);var _replace2 = require('lodash/replace');var _replace3 = _interopRequireDefault(_replace2);var _map5 = require('lodash/map');var _map6 = _interopRequireDefault(_map5);var _zipObject2 = require('lodash/zipObject');var _zipObject3 = _interopRequireDefault(_zipObject2);var _get2 = require('lodash/get');var _get3 = _interopRequireDefault(_get2);var _isPlainObject2 = require('lodash/isPlainObject');var _isPlainObject3 = _interopRequireDefault(_isPlainObject2);var _has2 = require('lodash/has');var _has3 = _interopRequireDefault(_has2);var _identity2 = require('lodash/identity');var _identity3 = _interopRequireDefault(_identity2);var _defaults2 = require('lodash/defaults');var _defaults3 = _interopRequireDefault(_defaults2);var _toUpper2 = require('lodash/toUpper');var _toUpper3 = _interopRequireDefault(_toUpper2);var _isNumber2 = require('lodash/isNumber');var _isNumber3 = _interopRequireDefault(_isNumber2);var _isString2 = require('lodash/isString');var _isString3 = _interopRequireDefault(_isString2);var _isObject2 = require('lodash/isObject');var _isObject3 = _interopRequireDefault(_isObject2);

















































































/**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Processes a "non-raw" response.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * This will consume the response with the desired `responseFormat`.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Which is one of: text, json, buffer, blob etc. See node-fetch's
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * body class for more information.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * @param {Object} response The http response from fetch.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * @param {Object} options HTTP request options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * @returns {Buffer|Object|String} The response in the desired format.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   */var consumeResponse = function () {var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(
  function _callee(response, _ref2) {var json = _ref2.json,_ref2$format = _ref2.format,format = _ref2$format === undefined ? 'text' : _ref2$format;var method, deserialize;return _regenerator2.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:
            method = json ? 'json' : format;
            deserialize = json ? JSON.parse : _identity3.default;if (!

            (0, _has3.default)(response, method)) {_context.next = 10;break;}_context.t1 =
            deserialize;_context.next = 6;return response[method]();case 6:_context.t2 = _context.sent;_context.t0 = (0, _context.t1)(_context.t2);_context.next = 15;break;case 10:_context.t3 =
            deserialize;_context.next = 13;return response.text();case 13:_context.t4 = _context.sent;_context.t0 = (0, _context.t3)(_context.t4);case 15:return _context.abrupt('return', _context.t0);case 16:case 'end':return _context.stop();}}}, _callee, this);}));return function consumeResponse(_x, _x2) {return _ref3.apply(this, arguments);};}();


/**
                                                                                                                                                                                                                                                                                                                                                                * The default response error handler, if none was supplied by the user.
                                                                                                                                                                                                                                                                                                                                                                * @param {Object} request The HTTP request object.
                                                                                                                                                                                                                                                                                                                                                                * @param {Object} response The HTTP response object.
                                                                                                                                                                                                                                                                                                                                                                */var _chainable = require('@jasonpollman/chainable');var _chainable2 = _interopRequireDefault(_chainable);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };} // In the browser, this will work with various bundlers like webpack
// using the native browser `fetch` implementation or a polyfill, but
// you'll need to ignore the `node-fetch` library.
// eslint-disable-next-line global-require
var fetch = typeof window !== 'undefined' ? window.fetch : require('node-fetch'); /**
                                                                                   * Stringifies object only, leaves other values untouched.
                                                                                   * @param {Object|string} value The value to maybe stringify.
                                                                                   * @returns {string} The original string input value, or the stringified value.
                                                                                   */ /**
                                                                                       * A chainable fetch library.
                                                                                       * @since 5/9/18
                                                                                       * @file
                                                                                       */var maybeStringify = function maybeStringify(value) {return (0, _isObject3.default)(value) ? (0, _stringify2.default)(value) : value;}; /**
                                                                                                                                                                                                                                  * Use to omit non-string, non-numeric, and non-object values from querystrings.
                                                                                                                                                                                                                                  * @param {any} value The value to inspect.
                                                                                                                                                                                                                                  * @returns {boolean} True if the value is a valid querystring value, false otherwise.
                                                                                                                                                                                                                                  */var isOfQueryStringType = function isOfQueryStringType(value) {return (0, _isString3.default)(value) || (0, _isNumber3.default)(value) || (0, _isObject3.default)(value);}; /**
                                                                                                                                                                                                                                                                                                                                                                                                                 * Removes nil values from objects.
                                                                                                                                                                                                                                                                                                                                                                                                                 * @function
                                                                                                                                                                                                                                                                                                                                                                                                                 */var withoutNilValues = (0, _pickBy3.default)((0, _negate3.default)(_isNil3.default)); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * Converts an object to a querystring.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * This differs from querystring.stringify in that it stringifies object values.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          * @function
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          */var querystringify = (0, _compose3.default)((0, _join3.default)('&'), (0, _map4.default)((0, _join3.default)('=')), _toPairs3.default, (0, _mapValues3.default)(encodeURIComponent), (0, _mapValues3.default)(maybeStringify), (0, _pickBy3.default)(isOfQueryStringType)); /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * The base headers applied to all requests if the `json` option is enabled.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * @type {Object<string>}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         */var JSONHeaders = { Accept: 'application/json', 'Content-Type': 'application/json' }; /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Formats the HTTP request options by formatting the href to include the query string,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * uppercasing the method, etc. You can pass additional options that node-fetch supports here
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * (such as 'follow', 'timeout', etc.).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @param {Object} options HTTP request options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * @returns {Object} The formatted request options.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */var formatRequestOptions = function formatRequestOptions(_ref) {var url = _ref.url,body = _ref.body,json = _ref.json,query = _ref.query,method = _ref.method,headers = _ref.headers,rest = (0, _objectWithoutProperties3.default)(_ref, ['url', 'body', 'json', 'query', 'method', 'headers']);return withoutNilValues((0, _extends3.default)({ method: (0, _toUpper3.default)(method), href: '' + url + (query ? '?' + querystringify(query) : ''), body: json ? (0, _stringify2.default)(body) : body, headers: json ? (0, _defaults3.default)({}, headers, JSONHeaders) : headers }, rest));};function handleResponseErrors(request, response, _ref4) {var url = _ref4.url;var status = response.status,statusText = response.statusText;throw (0, _assign2.default)(new Error('Request to ' + url + ' failed: ' + status + ' - ' + statusText), { request: request, response: response });} /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Creates a function that makes an HTTP request
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * using node-fetch and the provided method.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * @param {string} method The HTTP method this http request method is for.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * @returns {function} A http request function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */function initiateHttpRequest(method) {return function () {var _ref5 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};var options, interceptor, _interceptor, href, fetchOptions, response, responseInterceptor, handleResponseError;return _regenerator2.default.wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:if ((0, _isPlainObject3.default)(opts)) {_context2.next = 2;break;}throw new TypeError('Request options must be a plain object.');case 2:options = (0, _defaults3.default)({ url: this.toString(), method: method }, opts, this.requestOptions, { json: true }); // Pipe the options to the request interceptor, its return value will
              // be used in lieu of the given options. Here you can force headers, etc.
              interceptor = (0, _get3.default)(options, 'interceptors.request', _identity3.default);_interceptor = interceptor(formatRequestOptions(options)), href = _interceptor.href, fetchOptions = (0, _objectWithoutProperties3.default)(_interceptor, ['href']);_context2.next = 7;return fetch(href, fetchOptions);case 7:response = _context2.sent;if (!options.raw) {_context2.next = 10;break;}return _context2.abrupt('return', response);case 10:responseInterceptor = (0, _get3.default)(options, 'interceptors.response', _identity3.default);handleResponseError = (0, _get3.default)(options, 'handleResponseError', handleResponseErrors); // If the response is "ok" consume it and pipe it to the response interceptor.
              // If not, invoke the user's `handleResponseError` method.
              return _context2.abrupt('return', response.ok ? responseInterceptor(consumeResponse(response, options), options) : handleResponseError(request, response, options));case 13:case 'end':return _context2.stop();}}}, _callee2, this);}));function request() {return _ref5.apply(this, arguments);}return request;}();

}

/**
   * Creates a "base" chainable object for use with chainable-fetch.
   * @type {Object}
   */
var chainableFetch = function () {
  var methods = [
  'get',
  'put',
  'post',
  'delete',
  'option'];


  return (0, _chainable.chainableGeneratorWithDefaults)(
  (0, _assign2.default)((0, _zipObject3.default)(methods, (0, _map6.default)(methods, initiateHttpRequest)), {
    separator: '/',
    sanitizeLinks: encodeURIComponent,

    /**
                                        * A mechanism so users can use keywords like
                                        * `get` and `post` as path endpoints.
                                        * @param {string} endpoint The endpoint to push.
                                        * @returns {Proxy} The chainable child object.
                                        */
    path: function path(endpoint) {
      return (0, _chainable2.default)((0, _extends3.default)({},
      this, {
        tokens: [].concat((0, _toConsumableArray3.default)(this.tokens), [endpoint]) }));

    } }));


}();

/**
      * Creates a new chainable fetch api that will make requests to "options.host".
      * The given options will be merged with the defaults from above.
      * @function
      */exports.default =
function (options) {
  var requestOptions = (0, _isPlainObject3.default)(options) ? (0, _extends3.default)({}, options) : { host: options };

  // Not using url.parse for browser support.
  // @todo This could be a bit more comprehensive.
  var _ref6 = (0, _get3.default)(requestOptions, 'host', '').match(/(https?):\/\/(.*)/) || [],_ref7 = (0, _slicedToArray3.default)(_ref6, 3),protocol = _ref7[1],hostname = _ref7[2];

  if (!protocol || !hostname) {
    throw new TypeError(
    'Host must be a valid url with a protocol and hostname.');

  }

  return chainableFetch({
    prefix: (0, _replace3.default)(requestOptions.host, /\/$/, ''),
    requestOptions: requestOptions });

};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jaGFpbmFibGUtZmV0Y2guanMiXSwibmFtZXMiOlsicmVzcG9uc2UiLCJqc29uIiwiZm9ybWF0IiwibWV0aG9kIiwiZGVzZXJpYWxpemUiLCJKU09OIiwicGFyc2UiLCJ0ZXh0IiwiY29uc3VtZVJlc3BvbnNlIiwiZmV0Y2giLCJ3aW5kb3ciLCJyZXF1aXJlIiwibWF5YmVTdHJpbmdpZnkiLCJ2YWx1ZSIsImlzT2ZRdWVyeVN0cmluZ1R5cGUiLCJ3aXRob3V0TmlsVmFsdWVzIiwicXVlcnlzdHJpbmdpZnkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OSGVhZGVycyIsIkFjY2VwdCIsImZvcm1hdFJlcXVlc3RPcHRpb25zIiwidXJsIiwiYm9keSIsInF1ZXJ5IiwiaGVhZGVycyIsInJlc3QiLCJocmVmIiwiaGFuZGxlUmVzcG9uc2VFcnJvcnMiLCJyZXF1ZXN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIkVycm9yIiwiaW5pdGlhdGVIdHRwUmVxdWVzdCIsIm9wdHMiLCJUeXBlRXJyb3IiLCJvcHRpb25zIiwidG9TdHJpbmciLCJyZXF1ZXN0T3B0aW9ucyIsImludGVyY2VwdG9yIiwiZmV0Y2hPcHRpb25zIiwicmF3IiwicmVzcG9uc2VJbnRlcmNlcHRvciIsImhhbmRsZVJlc3BvbnNlRXJyb3IiLCJvayIsImNoYWluYWJsZUZldGNoIiwibWV0aG9kcyIsInNlcGFyYXRvciIsInNhbml0aXplTGlua3MiLCJwYXRoIiwiZW5kcG9pbnQiLCJ0b2tlbnMiLCJob3N0IiwibWF0Y2giLCJwcm90b2NvbCIsImhvc3RuYW1lIiwicHJlZml4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBa0ZBOzs7Ozs7Ozs7QUFTQSxtQkFBK0JBLFFBQS9CLGNBQTJDQyxJQUEzQyxTQUEyQ0EsSUFBM0Msc0JBQWlEQyxNQUFqRCxDQUFp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QUF3QjtBQUM1QixhQUFPO0FBQ0YsVUFERTtBQUVMQywyREFBWSxLQUFLQSxNQUFqQixJQUF5QkQsUUFBekIsRUFGSyxJQUFQOztBQUlELEtBZnNFLEVBQXpFLENBREssQ0FBUDs7O0FBbUJELENBNUJzQixFQUF2Qjs7QUE4QkE7Ozs7O0FBS2UsVUFBQ2QsT0FBRCxFQUFhO0FBQzFCLE1BQU1FLGlCQUFpQiw2QkFBZ0JGLE9BQWhCLCtCQUFnQ0EsT0FBaEMsSUFBNEMsRUFBRWdCLE1BQU1oQixPQUFSLEVBQW5FOztBQUVBO0FBQ0E7QUFKMEIsY0FLSyxtQkFBTUUsY0FBTixFQUFzQixNQUF0QixFQUE4QixFQUE5QixFQUFrQ2UsS0FBbEMsQ0FBd0MsbUJBQXhDLEtBQWdFLEVBTHJFLGdEQUtqQkMsUUFMaUIsWUFLUEMsUUFMTzs7QUFPMUIsTUFBSSxDQUFDRCxRQUFELElBQWEsQ0FBQ0MsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxJQUFJcEIsU0FBSjtBQUNKLDREQURJLENBQU47O0FBR0Q7O0FBRUQsU0FBT1UsZUFBZTtBQUNwQlcsWUFBUSx1QkFBVWxCLGVBQWVjLElBQXpCLEVBQStCLEtBQS9CLEVBQXNDLEVBQXRDLENBRFk7QUFFcEJkLGtDQUZvQixFQUFmLENBQVA7O0FBSUQsQyIsImZpbGUiOiJjaGFpbmFibGUtZmV0Y2guanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEEgY2hhaW5hYmxlIGZldGNoIGxpYnJhcnkuXG4gKiBAc2luY2UgNS85LzE4XG4gKiBAZmlsZVxuICovXG5cbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgZnAgZnJvbSAnbG9kYXNoL2ZwJztcbmltcG9ydCBjaGFpbmFibGUsIHsgY2hhaW5hYmxlR2VuZXJhdG9yV2l0aERlZmF1bHRzIH0gZnJvbSAnQGphc29ucG9sbG1hbi9jaGFpbmFibGUnO1xuXG4vLyBJbiB0aGUgYnJvd3NlciwgdGhpcyB3aWxsIHdvcmsgd2l0aCB2YXJpb3VzIGJ1bmRsZXJzIGxpa2Ugd2VicGFja1xuLy8gdXNpbmcgdGhlIG5hdGl2ZSBicm93c2VyIGBmZXRjaGAgaW1wbGVtZW50YXRpb24gb3IgYSBwb2x5ZmlsbCwgYnV0XG4vLyB5b3UnbGwgbmVlZCB0byBpZ25vcmUgdGhlIGBub2RlLWZldGNoYCBsaWJyYXJ5LlxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGdsb2JhbC1yZXF1aXJlXG5jb25zdCBmZXRjaCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmZldGNoIDogcmVxdWlyZSgnbm9kZS1mZXRjaCcpO1xuXG4vKipcbiAqIFN0cmluZ2lmaWVzIG9iamVjdCBvbmx5LCBsZWF2ZXMgb3RoZXIgdmFsdWVzIHVudG91Y2hlZC5cbiAqIEBwYXJhbSB7T2JqZWN0fHN0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIG1heWJlIHN0cmluZ2lmeS5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBvcmlnaW5hbCBzdHJpbmcgaW5wdXQgdmFsdWUsIG9yIHRoZSBzdHJpbmdpZmllZCB2YWx1ZS5cbiAqL1xuY29uc3QgbWF5YmVTdHJpbmdpZnkgPSB2YWx1ZSA9PiAoXy5pc09iamVjdCh2YWx1ZSkgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgOiB2YWx1ZSk7XG5cbi8qKlxuICogVXNlIHRvIG9taXQgbm9uLXN0cmluZywgbm9uLW51bWVyaWMsIGFuZCBub24tb2JqZWN0IHZhbHVlcyBmcm9tIHF1ZXJ5c3RyaW5ncy5cbiAqIEBwYXJhbSB7YW55fSB2YWx1ZSBUaGUgdmFsdWUgdG8gaW5zcGVjdC5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBhIHZhbGlkIHF1ZXJ5c3RyaW5nIHZhbHVlLCBmYWxzZSBvdGhlcndpc2UuXG4gKi9cbmNvbnN0IGlzT2ZRdWVyeVN0cmluZ1R5cGUgPSB2YWx1ZSA9PiBfLmlzU3RyaW5nKHZhbHVlKSB8fCBfLmlzTnVtYmVyKHZhbHVlKSB8fCBfLmlzT2JqZWN0KHZhbHVlKTtcblxuLyoqXG4gKiBSZW1vdmVzIG5pbCB2YWx1ZXMgZnJvbSBvYmplY3RzLlxuICogQGZ1bmN0aW9uXG4gKi9cbmNvbnN0IHdpdGhvdXROaWxWYWx1ZXMgPSBmcC5waWNrQnkoZnAubmVnYXRlKGZwLmlzTmlsKSk7XG5cbi8qKlxuICogQ29udmVydHMgYW4gb2JqZWN0IHRvIGEgcXVlcnlzdHJpbmcuXG4gKiBUaGlzIGRpZmZlcnMgZnJvbSBxdWVyeXN0cmluZy5zdHJpbmdpZnkgaW4gdGhhdCBpdCBzdHJpbmdpZmllcyBvYmplY3QgdmFsdWVzLlxuICogQGZ1bmN0aW9uXG4gKi9cbmNvbnN0IHF1ZXJ5c3RyaW5naWZ5ID0gZnAuY29tcG9zZShcbiAgZnAuam9pbignJicpLFxuICBmcC5tYXAoZnAuam9pbignPScpKSxcbiAgZnAudG9QYWlycyxcbiAgZnAubWFwVmFsdWVzKGVuY29kZVVSSUNvbXBvbmVudCksXG4gIGZwLm1hcFZhbHVlcyhtYXliZVN0cmluZ2lmeSksXG4gIGZwLnBpY2tCeShpc09mUXVlcnlTdHJpbmdUeXBlKSxcbik7XG5cbi8qKlxuICogVGhlIGJhc2UgaGVhZGVycyBhcHBsaWVkIHRvIGFsbCByZXF1ZXN0cyBpZiB0aGUgYGpzb25gIG9wdGlvbiBpcyBlbmFibGVkLlxuICogQHR5cGUge09iamVjdDxzdHJpbmc+fVxuICovXG5jb25zdCBKU09OSGVhZGVycyA9IHtcbiAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG59O1xuXG4vKipcbiAqIEZvcm1hdHMgdGhlIEhUVFAgcmVxdWVzdCBvcHRpb25zIGJ5IGZvcm1hdHRpbmcgdGhlIGhyZWYgdG8gaW5jbHVkZSB0aGUgcXVlcnkgc3RyaW5nLFxuICogdXBwZXJjYXNpbmcgdGhlIG1ldGhvZCwgZXRjLiBZb3UgY2FuIHBhc3MgYWRkaXRpb25hbCBvcHRpb25zIHRoYXQgbm9kZS1mZXRjaCBzdXBwb3J0cyBoZXJlXG4gKiAoc3VjaCBhcyAnZm9sbG93JywgJ3RpbWVvdXQnLCBldGMuKS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIEhUVFAgcmVxdWVzdCBvcHRpb25zLlxuICogQHJldHVybnMge09iamVjdH0gVGhlIGZvcm1hdHRlZCByZXF1ZXN0IG9wdGlvbnMuXG4gKi9cbmNvbnN0IGZvcm1hdFJlcXVlc3RPcHRpb25zID0gKHtcbiAgdXJsLFxuICBib2R5LFxuICBqc29uLFxuICBxdWVyeSxcbiAgbWV0aG9kLFxuICBoZWFkZXJzLFxuICAuLi5yZXN0XG59KSA9PiB3aXRob3V0TmlsVmFsdWVzKHtcbiAgbWV0aG9kOiBfLnRvVXBwZXIobWV0aG9kKSxcbiAgaHJlZjogYCR7dXJsfSR7cXVlcnkgPyBgPyR7cXVlcnlzdHJpbmdpZnkocXVlcnkpfWAgOiAnJ31gLFxuICBib2R5OiBqc29uID8gSlNPTi5zdHJpbmdpZnkoYm9keSkgOiBib2R5LFxuICBoZWFkZXJzOiBqc29uID8gXy5kZWZhdWx0cyh7fSwgaGVhZGVycywgSlNPTkhlYWRlcnMpIDogaGVhZGVycyxcbiAgLi4ucmVzdCxcbn0pO1xuXG4vKipcbiAqIFByb2Nlc3NlcyBhIFwibm9uLXJhd1wiIHJlc3BvbnNlLlxuICogVGhpcyB3aWxsIGNvbnN1bWUgdGhlIHJlc3BvbnNlIHdpdGggdGhlIGRlc2lyZWQgYHJlc3BvbnNlRm9ybWF0YC5cbiAqIFdoaWNoIGlzIG9uZSBvZjogdGV4dCwganNvbiwgYnVmZmVyLCBibG9iIGV0Yy4gU2VlIG5vZGUtZmV0Y2gnc1xuICogYm9keSBjbGFzcyBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAqIEBwYXJhbSB7T2JqZWN0fSByZXNwb25zZSBUaGUgaHR0cCByZXNwb25zZSBmcm9tIGZldGNoLlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgSFRUUCByZXF1ZXN0IG9wdGlvbnMuXG4gKiBAcmV0dXJucyB7QnVmZmVyfE9iamVjdHxTdHJpbmd9IFRoZSByZXNwb25zZSBpbiB0aGUgZGVzaXJlZCBmb3JtYXQuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvbnN1bWVSZXNwb25zZShyZXNwb25zZSwgeyBqc29uLCBmb3JtYXQgPSAndGV4dCcgfSkge1xuICBjb25zdCBtZXRob2QgPSBqc29uID8gJ2pzb24nIDogZm9ybWF0O1xuICBjb25zdCBkZXNlcmlhbGl6ZSA9IGpzb24gPyBKU09OLnBhcnNlIDogXy5pZGVudGl0eTtcblxuICByZXR1cm4gXy5oYXMocmVzcG9uc2UsIG1ldGhvZClcbiAgICA/IGRlc2VyaWFsaXplKGF3YWl0IHJlc3BvbnNlW21ldGhvZF0oKSlcbiAgICA6IGRlc2VyaWFsaXplKGF3YWl0IHJlc3BvbnNlLnRleHQoKSk7XG59XG5cbi8qKlxuICogVGhlIGRlZmF1bHQgcmVzcG9uc2UgZXJyb3IgaGFuZGxlciwgaWYgbm9uZSB3YXMgc3VwcGxpZWQgYnkgdGhlIHVzZXIuXG4gKiBAcGFyYW0ge09iamVjdH0gcmVxdWVzdCBUaGUgSFRUUCByZXF1ZXN0IG9iamVjdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSByZXNwb25zZSBUaGUgSFRUUCByZXNwb25zZSBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlRXJyb3JzKHJlcXVlc3QsIHJlc3BvbnNlLCB7IHVybCB9KSB7XG4gIGNvbnN0IHsgc3RhdHVzLCBzdGF0dXNUZXh0IH0gPSByZXNwb25zZTtcbiAgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IoYFJlcXVlc3QgdG8gJHt1cmx9IGZhaWxlZDogJHtzdGF0dXN9IC0gJHtzdGF0dXNUZXh0fWApLCB7XG4gICAgcmVxdWVzdCxcbiAgICByZXNwb25zZSxcbiAgfSk7XG59XG5cblxuLyoqXG4gKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBtYWtlcyBhbiBIVFRQIHJlcXVlc3RcbiAqIHVzaW5nIG5vZGUtZmV0Y2ggYW5kIHRoZSBwcm92aWRlZCBtZXRob2QuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kIFRoZSBIVFRQIG1ldGhvZCB0aGlzIGh0dHAgcmVxdWVzdCBtZXRob2QgaXMgZm9yLlxuICogQHJldHVybnMge2Z1bmN0aW9ufSBBIGh0dHAgcmVxdWVzdCBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gaW5pdGlhdGVIdHRwUmVxdWVzdChtZXRob2QpIHtcbiAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3Qob3B0cyA9IHt9KSB7XG4gICAgaWYgKCFfLmlzUGxhaW5PYmplY3Qob3B0cykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1JlcXVlc3Qgb3B0aW9ucyBtdXN0IGJlIGEgcGxhaW4gb2JqZWN0LicpO1xuICAgIH1cblxuICAgIGNvbnN0IG9wdGlvbnMgPSBfLmRlZmF1bHRzKHsgdXJsOiB0aGlzLnRvU3RyaW5nKCksIG1ldGhvZCB9LCBvcHRzLCB0aGlzLnJlcXVlc3RPcHRpb25zLCB7XG4gICAgICBqc29uOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gUGlwZSB0aGUgb3B0aW9ucyB0byB0aGUgcmVxdWVzdCBpbnRlcmNlcHRvciwgaXRzIHJldHVybiB2YWx1ZSB3aWxsXG4gICAgLy8gYmUgdXNlZCBpbiBsaWV1IG9mIHRoZSBnaXZlbiBvcHRpb25zLiBIZXJlIHlvdSBjYW4gZm9yY2UgaGVhZGVycywgZXRjLlxuICAgIGNvbnN0IGludGVyY2VwdG9yID0gXy5nZXQob3B0aW9ucywgJ2ludGVyY2VwdG9ycy5yZXF1ZXN0JywgXy5pZGVudGl0eSk7XG4gICAgY29uc3QgeyBocmVmLCAuLi5mZXRjaE9wdGlvbnMgfSA9IGludGVyY2VwdG9yKGZvcm1hdFJlcXVlc3RPcHRpb25zKG9wdGlvbnMpKTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goaHJlZiwgZmV0Y2hPcHRpb25zKTtcbiAgICBpZiAob3B0aW9ucy5yYXcpIHJldHVybiByZXNwb25zZTtcblxuICAgIGNvbnN0IHJlc3BvbnNlSW50ZXJjZXB0b3IgPSBfLmdldChvcHRpb25zLCAnaW50ZXJjZXB0b3JzLnJlc3BvbnNlJywgXy5pZGVudGl0eSk7XG4gICAgY29uc3QgaGFuZGxlUmVzcG9uc2VFcnJvciA9IF8uZ2V0KG9wdGlvbnMsICdoYW5kbGVSZXNwb25zZUVycm9yJywgaGFuZGxlUmVzcG9uc2VFcnJvcnMpO1xuXG4gICAgLy8gSWYgdGhlIHJlc3BvbnNlIGlzIFwib2tcIiBjb25zdW1lIGl0IGFuZCBwaXBlIGl0IHRvIHRoZSByZXNwb25zZSBpbnRlcmNlcHRvci5cbiAgICAvLyBJZiBub3QsIGludm9rZSB0aGUgdXNlcidzIGBoYW5kbGVSZXNwb25zZUVycm9yYCBtZXRob2QuXG4gICAgcmV0dXJuIHJlc3BvbnNlLm9rXG4gICAgICA/IHJlc3BvbnNlSW50ZXJjZXB0b3IoY29uc3VtZVJlc3BvbnNlKHJlc3BvbnNlLCBvcHRpb25zKSwgb3B0aW9ucylcbiAgICAgIDogaGFuZGxlUmVzcG9uc2VFcnJvcihyZXF1ZXN0LCByZXNwb25zZSwgb3B0aW9ucyk7XG4gIH07XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFwiYmFzZVwiIGNoYWluYWJsZSBvYmplY3QgZm9yIHVzZSB3aXRoIGNoYWluYWJsZS1mZXRjaC5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbmNvbnN0IGNoYWluYWJsZUZldGNoID0gKCgpID0+IHtcbiAgY29uc3QgbWV0aG9kcyA9IFtcbiAgICAnZ2V0JyxcbiAgICAncHV0JyxcbiAgICAncG9zdCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ29wdGlvbicsXG4gIF07XG5cbiAgcmV0dXJuIGNoYWluYWJsZUdlbmVyYXRvcldpdGhEZWZhdWx0cyhcbiAgICBPYmplY3QuYXNzaWduKF8uemlwT2JqZWN0KG1ldGhvZHMsIF8ubWFwKG1ldGhvZHMsIGluaXRpYXRlSHR0cFJlcXVlc3QpKSwge1xuICAgICAgc2VwYXJhdG9yOiAnLycsXG4gICAgICBzYW5pdGl6ZUxpbmtzOiBlbmNvZGVVUklDb21wb25lbnQsXG5cbiAgICAgIC8qKlxuICAgICAgICogQSBtZWNoYW5pc20gc28gdXNlcnMgY2FuIHVzZSBrZXl3b3JkcyBsaWtlXG4gICAgICAgKiBgZ2V0YCBhbmQgYHBvc3RgIGFzIHBhdGggZW5kcG9pbnRzLlxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGVuZHBvaW50IFRoZSBlbmRwb2ludCB0byBwdXNoLlxuICAgICAgICogQHJldHVybnMge1Byb3h5fSBUaGUgY2hhaW5hYmxlIGNoaWxkIG9iamVjdC5cbiAgICAgICAqL1xuICAgICAgcGF0aDogZnVuY3Rpb24gcGF0aChlbmRwb2ludCkge1xuICAgICAgICByZXR1cm4gY2hhaW5hYmxlKHtcbiAgICAgICAgICAuLi50aGlzLFxuICAgICAgICAgIHRva2VuczogWy4uLnRoaXMudG9rZW5zLCBlbmRwb2ludF0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KSxcbiAgKTtcbn0pKCk7XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBjaGFpbmFibGUgZmV0Y2ggYXBpIHRoYXQgd2lsbCBtYWtlIHJlcXVlc3RzIHRvIFwib3B0aW9ucy5ob3N0XCIuXG4gKiBUaGUgZ2l2ZW4gb3B0aW9ucyB3aWxsIGJlIG1lcmdlZCB3aXRoIHRoZSBkZWZhdWx0cyBmcm9tIGFib3ZlLlxuICogQGZ1bmN0aW9uXG4gKi9cbmV4cG9ydCBkZWZhdWx0IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHJlcXVlc3RPcHRpb25zID0gXy5pc1BsYWluT2JqZWN0KG9wdGlvbnMpID8geyAuLi5vcHRpb25zIH0gOiB7IGhvc3Q6IG9wdGlvbnMgfTtcblxuICAvLyBOb3QgdXNpbmcgdXJsLnBhcnNlIGZvciBicm93c2VyIHN1cHBvcnQuXG4gIC8vIEB0b2RvIFRoaXMgY291bGQgYmUgYSBiaXQgbW9yZSBjb21wcmVoZW5zaXZlLlxuICBjb25zdCBbLCBwcm90b2NvbCwgaG9zdG5hbWVdID0gXy5nZXQocmVxdWVzdE9wdGlvbnMsICdob3N0JywgJycpLm1hdGNoKC8oaHR0cHM/KTpcXC9cXC8oLiopLykgfHwgW107XG5cbiAgaWYgKCFwcm90b2NvbCB8fCAhaG9zdG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgJ0hvc3QgbXVzdCBiZSBhIHZhbGlkIHVybCB3aXRoIGEgcHJvdG9jb2wgYW5kIGhvc3RuYW1lLicsXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBjaGFpbmFibGVGZXRjaCh7XG4gICAgcHJlZml4OiBfLnJlcGxhY2UocmVxdWVzdE9wdGlvbnMuaG9zdCwgL1xcLyQvLCAnJyksXG4gICAgcmVxdWVzdE9wdGlvbnMsXG4gIH0pO1xufTtcbiJdfQ==
